import{d as e,r as a,a as l,b as t,o as r,h as s,w as i,t as u,v as o,f as d,q as v,x as n,u as m,aa as c,z as p,i as w,g as h,y as f}from"./index-6dfdc0ee.js";import{_ as b}from"./Dialog.vue_vue_type_style_index_0_lang-6e721bb1.js";const _=e({__name:"DepartmentDialog",setup(e,{expose:_}){const g=a(!1),y=a([]),x=a({isView:!1,title:"",row:{},labelWidth:160,fullscreen:!1,maxHeight:"500px"}),V=async()=>{try{const e=await c.list({});y.value=Array.isArray(e.data)?e.data:[]}catch(e){p.error("获取部门列表失败")}};_({acceptParams:e=>{e.row={...x.value.row,...e.row},x.value={...x.value,...e},V(),g.value=!0}});const k=l({name:[{required:!0,message:"请输入部门名称",trigger:"blur"}]}),q=a(),D=()=>{q.value.validate(async e=>{if(e)try{delete x.value.row.updateTime,delete x.value.row.createTime,await x.value.api(x.value.row),p.success({message:`${x.value.title}成功！`}),x.value.getTableList(),g.value=!1,q.value.resetFields(),V(),F(!0)}catch(a){}})},F=e=>{g.value=!1;(["查看","编辑"].includes(x.value.title)||e)&&(x.value.row={},q.value.resetFields())};return(e,a)=>{const l=t("el-input"),c=t("el-form-item"),p=t("el-cascader"),_=t("el-form"),V=t("el-button");return r(),s(m(b),{"model-value":g.value,title:x.value.title,fullscreen:x.value.fullscreen,"max-height":x.value.maxHeight,"cancel-dialog":F,width:"45%"},{footer:i(()=>[u(e.$slots,"footer",{},()=>[d(V,{onClick:F},{default:i(()=>[...a[2]||(a[2]=[w("取消",-1)])]),_:1}),h(d(V,{type:"primary",onClick:D},{default:i(()=>[...a[3]||(a[3]=[w("确定",-1)])]),_:1},512),[[f,!x.value.isView]])])]),default:i(()=>[o("div",{style:n("width: calc(100% - "+x.value.labelWidth/2+"px)")},[d(_,{ref_key:"ruleFormRef",ref:q,"label-position":"right","label-width":x.value.labelWidth+"px",rules:k,model:x.value.row,disabled:x.value.isView,"hide-required-asterisk":x.value.isView},{default:i(()=>[d(c,{label:"部门名称",prop:"name"},{default:i(()=>[d(l,{modelValue:x.value.row.name,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.row.name=e),placeholder:"请填写部门名称",clearable:"",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),1!==x.value.row.level?(r(),s(c,{key:0,label:"父级部门",prop:"parentId"},{default:i(()=>[d(p,{modelValue:x.value.row.parentId,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.row.parentId=e),props:{value:"id",label:"name",emitPath:!1,checkStrictly:!0},placeholder:"请选择父级部门",options:y.value,"show-all-levels":!1,filterable:""},null,8,["modelValue","options"])]),_:1})):v("",!0)]),_:1},8,["label-width","rules","model","disabled","hide-required-asterisk"])],4)]),_:3},8,["model-value","title","fullscreen","max-height"])}}});export{_};
