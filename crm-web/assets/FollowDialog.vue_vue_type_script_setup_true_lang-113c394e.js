import{d as e,r as l,a,b as o,o as t,h as u,w as r,t as s,v as d,f as i,e as n,B as v,u as m,F as p,x as w,i as c,g as f,y as b,z as h}from"./index-6dfdc0ee.js";import{_ as g}from"./Dialog.vue_vue_type_style_index_0_lang-6e721bb1.js";import{a as y,d as _}from"./enum-ebf888b2.js";const V=e({__name:"FollowDialog",setup(e,{expose:V}){const x=l(!1),T=l({isView:!1,title:"",row:{},labelWidth:160,fullscreen:!1,maxHeight:"500px"});V({acceptParams:e=>{e.row={...T.value.row,...e.row},T.value={...T.value,...e},x.value=!0}});const F=a({followType:[{required:!0,message:"跟进方式不能为空",trigger:"blur"}],nextFollowType:[{required:!0,message:"下次跟进时间不能为空",trigger:"blur"}],content:[{required:!0,message:"跟进内容不能为空",trigger:"blur"}]}),k=l(),U=()=>{k.value.validate(async e=>{if(e)try{delete T.value.row.updateTime,delete T.value.row.createTime,"function"==typeof T.value.api?(await T.value.api(T.value.row),h.success({message:`${T.value.title}成功！`}),"function"==typeof T.value.getTableList&&T.value.getTableList(),x.value=!1,k.value.resetFields(),j(!0)):h.error("请配置提交接口")}catch(l){h.error("提交失败，请稍后重试")}})},j=e=>{x.value=!1;(["查看","编辑"].includes(T.value.title)||e)&&(T.value.row={},k.value.resetFields())};return(e,l)=>{const a=o("el-input"),h=o("el-form-item"),V=o("el-option"),q=o("el-select"),D=o("el-date-picker"),H=o("el-form"),Y=o("el-button");return t(),u(m(g),{"model-value":x.value,title:T.value.title,fullscreen:T.value.fullscreen,"max-height":T.value.maxHeight,"cancel-dialog":j,width:"50%"},{footer:r(()=>[s(e.$slots,"footer",{},()=>[i(Y,{onClick:j},{default:r(()=>[...l[6]||(l[6]=[c("取消",-1)])]),_:1}),f(i(Y,{type:"primary",onClick:U},{default:r(()=>[...l[7]||(l[7]=[c("确定",-1)])]),_:1},512),[[b,!T.value.isView]])])]),default:r(()=>[d("div",{style:w("width: calc(100% - "+T.value.labelWidth/2+"px)")},[i(H,{ref_key:"ruleFormRef",ref:k,"label-position":"right","label-width":T.value.labelWidth+"px",rules:F,model:T.value.row,disabled:T.value.isView,"hide-required-asterisk":T.value.isView},{default:r(()=>[i(h,{label:"线索名称",prop:"name"},{default:r(()=>[i(a,{modelValue:T.value.row.name,"onUpdate:modelValue":l[0]||(l[0]=e=>T.value.row.name=e),placeholder:"请填写线索名称",clearable:"",maxlength:"50","show-word-limit":"",readonly:!0},null,8,["modelValue"])]),_:1}),i(h,{label:"线索手机号",prop:"phone"},{default:r(()=>[i(a,{modelValue:T.value.row.phone,"onUpdate:modelValue":l[1]||(l[1]=e=>T.value.row.phone=e),placeholder:"请填写线索手机号",clearable:"",maxlength:"11","show-word-limit":"",readonly:!0},null,8,["modelValue"])]),_:1}),i(h,{label:"线索等级",prop:"level"},{default:r(()=>[i(q,{modelValue:T.value.row.level,"onUpdate:modelValue":l[2]||(l[2]=e=>T.value.row.level=e),filterable:"",placeholder:"请选择线索等级",class:"w-full",disabled:!0},{default:r(()=>[(t(!0),n(p,null,v(Object.values(m(y)),e=>(t(),u(V,{key:e.value,label:e.label,value:e.value,class:"isabel-option"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(h,{label:"跟进方式",prop:"followType"},{default:r(()=>[i(q,{modelValue:T.value.row.followType,"onUpdate:modelValue":l[3]||(l[3]=e=>T.value.row.followType=e),filterable:"",placeholder:"请选择跟进方式",class:"w-full"},{default:r(()=>[(t(!0),n(p,null,v(Object.values(m(_)),e=>(t(),u(V,{key:e.value,label:e.label,value:e.value,class:"isabel-option"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(h,{label:"下次跟进时间",prop:"nextFollowType"},{default:r(()=>[i(D,{modelValue:T.value.row.nextFollowType,"onUpdate:modelValue":l[4]||(l[4]=e=>T.value.row.nextFollowType=e),type:"datetime",placeholder:"请选择下次跟进时间","value-format":"YYYY-MM-DD HH:mm:ss","disabled-date":e=>e.getTime()<Date.now()-864e5},null,8,["modelValue","disabled-date"])]),_:1}),i(h,{label:"跟进内容",prop:"content"},{default:r(()=>[i(a,{modelValue:T.value.row.content,"onUpdate:modelValue":l[5]||(l[5]=e=>T.value.row.content=e),clearable:"",type:"textarea",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["label-width","rules","model","disabled","hide-required-asterisk"])],4)]),_:3},8,["model-value","title","fullscreen","max-height"])}}});export{V as _};
