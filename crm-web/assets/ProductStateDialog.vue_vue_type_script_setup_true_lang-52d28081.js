import{d as e,r as l,a3 as a,a9 as t,b as i,o as r,h as u,w as o,t as s,v,f as d,x as m,u as n,i as f,g as w,y as c,z as h}from"./index-6dfdc0ee.js";import{_ as p}from"./Dialog.vue_vue_type_style_index_0_lang-6e721bb1.js";const g=e({__name:"ProductStateDialog",setup(e,{expose:g}){const b=l(!1),_=l({isView:!1,title:"",row:{},labelWidth:160,fullscreen:!1,maxHeight:"500px"});g({acceptParams:e=>{e.row={..._.value.row,...e.row},_.value={..._.value,...e},"商品上架"===_.value.title?_.value.row.time=_.value.row.onShelfTime:_.value.row.time=_.value.row.offShelfTime,b.value=!0}});const x=a(()=>({time:[{required:!0,message:`请选择${_.value.title}时间`,trigger:"blur"},{validator:(e,l,a)=>{if(!l)return a(new Error(`请选择${_.value.title}时间`));const i=t();if(t(l).isBefore(i,"minute"))return a(new Error(`${_.value.title}时间不能早于当前时间`));a()},trigger:"change"}]})),y=l(),T=()=>{y.value.validate(async e=>{if(e)try{delete _.value.row.updateTime,delete _.value.row.createTime,"商品定时上架"===_.value.title?_.value.row.onShelfTime=_.value.row.time:_.value.row.offShelfTime=_.value.row.time,await _.value.api(_.value.row),h.success({message:`${_.value.title}成功！`}),_.value.getTableList(),b.value=!1,y.value.resetFields(),V(!0)}catch(l){}})},V=e=>{b.value=!1;(["查看","编辑"].includes(_.value.title)||e)&&(_.value.row={},y.value.resetFields())};return(e,l)=>{const a=i("el-date-picker"),t=i("el-form-item"),h=i("el-form"),g=i("el-button");return r(),u(n(p),{"model-value":b.value,title:_.value.title,fullscreen:_.value.fullscreen,"max-height":_.value.maxHeight,"cancel-dialog":V,width:"35%"},{footer:o(()=>[s(e.$slots,"footer",{},()=>[d(g,{onClick:V},{default:o(()=>[...l[1]||(l[1]=[f("取消",-1)])]),_:1}),w(d(g,{type:"primary",onClick:T},{default:o(()=>[...l[2]||(l[2]=[f("确定",-1)])]),_:1},512),[[c,!_.value.isView]])])]),default:o(()=>[v("div",{style:m("width: calc(100% - "+_.value.labelWidth/2+"px)")},[d(h,{ref_key:"ruleFormRef",ref:y,"label-position":"right","label-width":_.value.labelWidth+"px",rules:x.value,model:_.value.row,disabled:_.value.isView,"hide-required-asterisk":_.value.isView},{default:o(()=>[d(t,{label:_.value.title+"时间",prop:"time"},{default:o(()=>[d(a,{modelValue:_.value.row.time,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value.row.time=e),type:"datetime",placeholder:`请选择${_.value.title}时间`,"value-format":"YYYY-MM-DD HH:mm:ss","disabled-date":e=>e.getTime()<Date.now()-864e5},null,8,["modelValue","placeholder","disabled-date"])]),_:1},8,["label"])]),_:1},8,["label-width","rules","model","disabled","hide-required-asterisk"])],4)]),_:3},8,["model-value","title","fullscreen","max-height"])}}});export{g as _};
