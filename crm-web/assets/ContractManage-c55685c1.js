import{_ as e}from"./ContractDataChart.vue_vue_type_script_name_ContractPieChart_setup_true_lang-4cd4e7c2.js";import{C as a}from"./index-6fd7493a.js";import{h as l,g as t}from"./useMergeTime-5349e975.js";import{d as n,r as u,N as o,b as s,o as r,e as i,v as d,f as v,w as m,F as p,B as c,h as y,q as f,i as g,z as h}from"./index-6dfdc0ee.js";import"./index-623383b6.js";const w={class:"container-box"},Y={class:"select-box"},D={key:1},b={style:{height:"80vh",width:"100%"}},x=n({__name:"ContractManage",setup(n){const x=u("day"),_=u([]),V=u(),k=u(),M=u([{label:"日合同数据统计",value:"day"},{label:"周合同数据统计",value:"week"},{label:"月合同数据统计",value:"monthrange"},{label:"自定义时间合同数据统计",value:"daterange"}]),C=u({timeList:[],countList:[]});o(()=>{(async()=>{try{const e=await a.trendData({transactionType:x.value});C.value=e.data??{timeList:[],countList:[]}}catch(e){h.error("数据加载失败，请重试")}})()});const L=e=>{const a=Date.now(),l=new Date(a);return l.setHours(23,59,59,999),e.getTime()>l.getTime()},j=e=>{if(!V.value)return e>new Date;return e<new Date(V.value)||e>new Date},T=async()=>{try{let e={transactionType:x.value};if(0===_.value.length&&("daterange"===x.value||"monthrange"===x.value)||void 0===V.value&&void 0===k.value&&"week"===x.value)return void h({type:"warning",message:"请选择有效的时间范围"});if("monthrange"===x.value){const[a,t]=_.value,n=l(a).format("YYYY-MM-01 00:00:00"),u=l(t).endOf("month").format("YYYY-MM-DD 23:59:59");e={...e,timeRange:[n,u]}}else if("daterange"===x.value){const[a,t]=_.value,n=l(a).format("YYYY-MM-DD 00:00:00"),u=l(t).format("YYYY-MM-DD 23:59:59");e={...e,timeRange:[n,u]}}else if("week"===x.value){if(!(V.value instanceof Date&&k.value instanceof Date))return;{const[a]=t(V.value),[,l]=t(k.value);e={...e,timeRange:[a,l]}}}const n=await a.trendData(e);C.value=n.data??{timeList:[],countList:[]}}catch(e){h.error("数据加载失败，请重试")}};return(a,l)=>{const t=s("el-option"),n=s("el-select"),u=s("el-date-picker"),o=s("el-button");return r(),i("div",w,[d("div",Y,[l[7]||(l[7]=d("span",null,"筛选：",-1)),v(n,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value=e),placeholder:"Select",style:{width:"240px","margin-left":"20px"},onChange:l[1]||(l[1]=e=>(_.value=[],V.value=void 0,void(k.value=void 0)))},{default:m(()=>[(r(!0),i(p,null,c(M.value,e=>(r(),y(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),"day"!==x.value&&"week"!==x.value?(r(),y(u,{key:0,modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=e=>_.value=e),type:x.value,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"请选择统计时间",style:{"margin-left":"20px"},"unlink-panels":"","disabled-date":L},null,8,["modelValue","type"])):f("",!0),"day"!==x.value&&"week"===x.value?(r(),i("div",D,[v(u,{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=e=>V.value=e),type:x.value,format:"[第] ww [周]",placeholder:"请选择开始周",style:{"margin-left":"20px"},"disabled-date":L},null,8,["modelValue","type"]),l[5]||(l[5]=d("span",{style:{"margin-left":"20px"}},"至",-1)),v(u,{modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=e=>k.value=e),type:x.value,format:"[第] ww [周]",placeholder:"请选择结束周",style:{"margin-left":"20px"},"disabled-date":j},null,8,["modelValue","type"])])):f("",!0),v(o,{type:"primary",onClick:T,style:{"margin-left":"20px"}},{default:m(()=>[...l[6]||(l[6]=[g("搜索",-1)])]),_:1})]),d("div",b,[v(e,{data:C.value??{timeList:[],countList:[]}},null,8,["data"])])])}}});export{x as default};
