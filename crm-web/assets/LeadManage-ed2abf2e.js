import{_ as e}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-25415f8a.js";import{J as a,K as t,d as l,r as s,a as i,b as o,c as r,o as p,e as n,f as u,w as d,g as m,h as c,i as _,u as f,m as b,n as v,L as g,q as h,M as y}from"./index-6dfdc0ee.js";import{L as w,a as k,b as x,F as C,c as j}from"./enum-ebf888b2.js";import{_ as T}from"./LeadDialog.vue_vue_type_script_setup_true_lang-5786216f.js";import{u as L}from"./useHandleData-bcc6e8c1.js";import{_ as O}from"./FollowDialog.vue_vue_type_script_setup_true_lang-113c394e.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./print-7c839e56.js";import"./Dialog.vue_vue_type_style_index_0_lang-6e721bb1.js";const W={page:e=>a.post(t+"/lead/page",e),saveOrEdit:e=>a.post(t+"/lead/saveOrEdit",e),toCustomer:e=>a.post(t+"/lead/convertToCustomer",e),followLead:e=>a.post(t+"/lead/followLead",e)},E={class:"table-box"},D=l({__name:"LeadManage",setup(a){const t=s(),l=i({}),D=s(0),P=e=>(D.value=e.list.size,{list:e.list,total:e.total}),H=[{type:"selection",fixed:"left",width:60},{prop:"name",label:"线索名称",minWidth:120,search:{el:"input"}},{prop:"status",label:"线索状态",minWidth:120,enum:Object.values(w),search:{el:"select"}},{prop:"phone",label:"手机号",minWidth:160},{prop:"email",label:"邮箱",minWidth:120},{prop:"level",label:"客户级别",enum:Object.values(k),minWidth:120},{prop:"source",label:"客户来源",enum:Object.values(x),minWidth:120,search:{el:"select"}},{prop:"address",label:"客户地址",minWidth:120},{prop:"followStatus",label:"跟进状态",minWidth:120,enum:Object.values(C)},{prop:"nextFollowStatus",label:"下次跟进时间",minWidth:180},{prop:"createTime",label:"线索创建时间",minWidth:180},{prop:"operation",label:"操作",fixed:"right",width:300}],V=s(),N=(e,a={})=>{let l={title:e,row:{...a},isView:"查看"===e,api:W.saveOrEdit,getTableList:t.value.getTableList,maxHeight:"450px"};V.value.acceptParams(l)},R=s();return(a,s)=>{const i=o("el-button"),w=r("hasPermi");return p(),n("div",E,[u(e,{ref_key:"proTable",ref:t,title:"线索管理",columns:H,requestApi:f(W).page,initParam:l,dataCallback:P,searchCol:{xs:2,sm:3,md:4,lg:6,xl:8}},{tableHeader:d(()=>[m((p(),c(i,{type:"primary",icon:f(b),onClick:s[0]||(s[0]=e=>N("新增"))},{default:d(()=>[...s[1]||(s[1]=[_("新增线索",-1)])]),_:1},8,["icon"])),[[w,["sys:lead:add"]]])]),operation:d(e=>[m((p(),c(i,{type:"primary",link:"",icon:f(v),onClick:a=>N("编辑",e.row)},{default:d(()=>[...s[2]||(s[2]=[_("编辑",-1)])]),_:1},8,["icon","onClick"])),[[w,["sys:lead:edit"]]]),e.row.status===f(j).NOT_CONVERTED?m((p(),c(i,{key:0,type:"info",link:"",icon:f(g),onClick:a=>((e,a={})=>{let l={title:e,row:{...a},isView:"查看"===e,api:W.followLead,getTableList:t.value.getTableList,maxHeight:"450px"};R.value.acceptParams(l)})("编辑",e.row)},{default:d(()=>[...s[3]||(s[3]=[_("跟进线索",-1)])]),_:1},8,["icon","onClick"])),[[w,["sys:lead:follow"]]]):h("",!0),e.row.status===f(j).NOT_CONVERTED?m((p(),c(i,{key:1,type:"success",link:"",icon:f(y),onClick:a=>(async e=>{await L(W.toCustomer,{id:e},"转为客户"),t.value.clearSelection(),t.value.getTableList()})(e.row.id)},{default:d(()=>[...s[4]||(s[4]=[_("转为客户",-1)])]),_:1},8,["icon","onClick"])),[[w,["sys:lead:toCustomer"]]]):h("",!0)]),_:1},8,["requestApi","initParam"]),u(T,{ref_key:"dialogRef",ref:V},null,512),u(O,{ref_key:"followDialogRef",ref:R},null,512)])}}});export{D as default};
