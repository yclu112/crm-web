import{_ as e}from"./CustomerDataChart.vue_vue_type_script_name_ContractDataChart_setup_true_lang-8b1382dc.js";import{C as a}from"./index-d897ae39.js";import{h as l,g as t}from"./useMergeTime-5349e975.js";import{d as n,r as u,N as o,b as s,o as r,e as d,v,f as i,w as m,F as p,B as c,h as y,q as f,i as g,z as h}from"./index-6dfdc0ee.js";import"./index-623383b6.js";const w={class:"container-box"},D={class:"select-box"},Y={key:1},b={style:{height:"80vh",width:"100%"}},_=n({__name:"CustomerManage",setup(n){const _=u("day"),x=u([]),V=u(),k=u(),M=u([{label:"日客户数据统计",value:"day"},{label:"周客户数据统计",value:"week"},{label:"月客户数据统计",value:"monthrange"},{label:"自定义时间客户数据统计",value:"daterange"}]),C=u({timeList:[],countList:[]});o(()=>{(async()=>{try{const e=await a.trendData({transactionType:_.value});C.value=e.data}catch(e){}})()});const j=e=>{const a=Date.now(),l=new Date(a);return l.setHours(23,59,59,999),e.getTime()>l.getTime()},T=e=>{if(!V.value)return e>new Date;return e<new Date(V.value)||e>new Date},U=async()=>{try{let e={transactionType:_.value};if(0===x.value.length&&("daterange"===_.value||"monthrange"===_.value)||void 0===V.value&&void 0===k.value&&"week"===_.value)return void h({type:"warning",message:"请选择有效的时间范围"});if("monthrange"===_.value){const[a,t]=x.value,n=l(a).format("YYYY-MM-01 00:00:00"),u=l(t).endOf("month").format("YYYY-MM-DD 23:59:59");e={...e,timeRange:[n,u]}}else if("daterange"===_.value){const[a,t]=x.value,n=l(a).format("YYYY-MM-DD 00:00:00"),u=l(t).format("YYYY-MM-DD 23:59:59");e={...e,timeRange:[n,u]}}else if("week"===_.value){if(!(V.value instanceof Date&&k.value instanceof Date))return;{const[a]=t(V.value),[,l]=t(k.value);e={...e,timeRange:[a,l]}}}const n=await a.trendData(e);C.value=n.data}catch(e){}};return(a,l)=>{const t=s("el-option"),n=s("el-select"),u=s("el-date-picker"),o=s("el-button");return r(),d("div",w,[v("div",D,[l[7]||(l[7]=v("span",null,"筛选：",-1)),i(n,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=e=>_.value=e),placeholder:"Select",style:{width:"240px","margin-left":"20px"},onChange:l[1]||(l[1]=e=>(x.value=[],V.value=void 0,void(k.value=void 0)))},{default:m(()=>[(r(!0),d(p,null,c(M.value,e=>(r(),y(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),"day"!==_.value&&"week"!==_.value?(r(),y(u,{key:0,modelValue:x.value,"onUpdate:modelValue":l[2]||(l[2]=e=>x.value=e),type:_.value,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"请选择统计时间",style:{"margin-left":"20px"},"unlink-panels":"","disabled-date":j},null,8,["modelValue","type"])):f("",!0),"day"!==_.value&&"week"===_.value?(r(),d("div",Y,[i(u,{modelValue:V.value,"onUpdate:modelValue":l[3]||(l[3]=e=>V.value=e),type:_.value,format:"[第] ww [周]",placeholder:"请选择开始周",style:{"margin-left":"20px"},"disabled-date":j},null,8,["modelValue","type"]),l[5]||(l[5]=v("span",{style:{"margin-left":"20px"}},"至",-1)),i(u,{modelValue:k.value,"onUpdate:modelValue":l[4]||(l[4]=e=>k.value=e),type:_.value,format:"[第] ww [周]",placeholder:"请选择结束周",style:{"margin-left":"20px"},"disabled-date":T},null,8,["modelValue","type"])])):f("",!0),i(o,{type:"primary",onClick:U,style:{"margin-left":"20px"}},{default:m(()=>[...l[6]||(l[6]=[g("搜索",-1)])]),_:1})]),v("div",b,[i(e,{data:C.value||{}},null,8,["data"])])])}}});export{_ as default};
