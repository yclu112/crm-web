import{d as e,P as a,T as s,Q as o,r,a as l,N as t,b as n,o as i,e as u,f as d,w as c,u as p,U as m,V as f,v as g,i as w,W as _,X as v,F as y,Y as x,Z as b,C as h,_ as V}from"./index-6dfdc0ee.js";import{u as k}from"./tabs-3c29e5c5.js";import{g as j}from"./index-9223e28c.js";import{_ as F}from"./_plugin-vue_export-helper-1b428a4d.js";const U={class:"login-btn"},z=F(e({__name:"LoginForm",setup(e){const{push:F}=a(),z=k(),C=s(),T=o(),q=r(),E=l({account:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}),N=r(!1),P=l({account:"",password:""}),I=e=>{e&&e.validate(async e=>{if(e){N.value=!0;try{const{data:e}=await x(P);C.setToken(e.access_token);const{data:a}=await j();C.setUserinfo(a),await b(),z.closeMultipleTab(),F(T.homePath),h({title:V(),message:"欢迎登录",type:"success",duration:3e3})}finally{N.value=!1}}})};return t(()=>{document.onkeydown=e=>{if("Enter"===(e=window.event||e).code||"enter"===e.code||"NumpadEnter"===e.code){if(N.value)return;I(q.value)}}}),(e,a)=>{const s=n("el-input"),o=n("el-form-item"),r=n("el-form"),l=n("el-button");return i(),u(y,null,[d(r,{ref_key:"loginFormRef",ref:q,model:P,rules:E,size:"large"},{default:c(()=>[d(o,{prop:"account"},{default:c(()=>[d(s,{"prefix-icon":p(m),modelValue:P.account,"onUpdate:modelValue":a[0]||(a[0]=e=>P.account=e),placeholder:"用户名"},null,8,["prefix-icon","modelValue"])]),_:1}),d(o,{prop:"password"},{default:c(()=>[d(s,{"prefix-icon":p(f),type:"password",modelValue:P.password,"onUpdate:modelValue":a[1]||(a[1]=e=>P.password=e),placeholder:"密码","show-password":"",autocomplete:"new-password"},null,8,["prefix-icon","modelValue"])]),_:1})]),_:1},8,["model","rules"]),g("div",U,[d(l,{icon:p(_),round:"",onClick:a[2]||(a[2]=e=>{var a;(a=q.value)&&a.resetFields()}),size:"large"},{default:c(()=>[...a[4]||(a[4]=[w("重置",-1)])]),_:1},8,["icon"]),d(l,{icon:p(v),round:"",onClick:a[3]||(a[3]=e=>I(q.value)),size:"large",type:"primary",loading:N.value},{default:c(()=>[...a[5]||(a[5]=[w(" 登录 ",-1)])]),_:1},8,["icon","loading"])])],64)}}}),[["__scopeId","data-v-e3a65a36"]]);export{z as default};
